<!DOCTYPE html>
<html>
<head>
    <title>Напоминалка</title>
</head>
<style>
.container{
    display: flex;
    flex-direction: column;
    gap: 5px;
    width: 500px;
    padding: 20px 30px;
    margin: 0 auto;
    background-color: crimson;
    border-radius: 15px;
}
input{
    background-color: white;
    border: none;
    padding: 5px;
}
button{
    background-color:white;
    border: none;
    padding: 10px 5px;
}
button:hover{
    background-color:rgb(0, 0, 0);
    color: white;
}
canvas{
    margin: 0 auto;
    width: 100%; 
    height: 250px;
}
.list{
    border: 2px solid pink;
    padding: 20px 30px;

}
</style>
<body>
    <p>
        6. Реализуйте на ООП программу-напоминалку. Как она должна работать: вы
        записываете в специальное поле какие-то события, о которых вам нужно
        напомнить и в нужное время вкладка браузера с этой программой должна
        напомнить об этом событии звуком (погуглите работу с аудио на js).
      </p>
    <div class="container">
        <input type="text" id="reminderText" />
        <input type="datetime-local" value="2023-11-17T12:30" id="reminderTime" />
        <button onclick="addReminder()">Добавить напоминание</button>
    </div>
    <br>
   <div class="list">
    <h3>List of your task</h3>
    <canvas id="reminderCanvas" ></canvas>
   </div>

    <script>
        class Reminder {
            constructor(text, time) {
                this.text = text;
                this.time = time;
            }
        }
        class ReminderCanvas {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.context = this.canvas.getContext('2d');
                this.reminders = [];

                this.render();

                setInterval(() => {
                    this.checkReminders();
                    this.render();
                }, 1000);
            }

            addReminder(reminder) {
                this.reminders.push(reminder);
            }

            checkReminders() {
                const currentTime = new Date();
                const remindersToRemove = [];

                for (const reminder of this.reminders) {
                    if (reminder.time <= currentTime) {
                        remindersToRemove.push(reminder);
                        this.playReminderSound();
                    }
                }

                for (const reminder of remindersToRemove) {
                    const index = this.reminders.indexOf(reminder);
                    if (index > -1) {
                        alert(`Наапоминание:`+ this.reminders[index].text )
                        this.reminders.splice(index, 1);
                    }
                }
            }

            playReminderSound() {
                const audio = new Audio('reminder-sound.mp3');
                audio.play();
            }

            render() {
                this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.context.font = '16px Arial';

                for (let i = 0; i < this.reminders.length; i++) {
                    const reminder = this.reminders[i];
                    const y = 30 + i * 30;

                    this.context.fillText(reminder.text, 20, y);

                    const timeString = reminder.time.toLocaleString();
                    this.context.fillText(timeString, 300, y);
                }
            }
        }

        const reminderCanvas = new ReminderCanvas('reminderCanvas');
        // const index = this.reminders.indexOf(reminder);
        //                 alert(this.reminders[index])
                   
        function addReminder() {
            const textInput = document.getElementById('reminderText');
            const timeInput = document.getElementById('reminderTime');

            const text = textInput.value;
            const time = new Date(timeInput.value);

            const reminder = new Reminder(text, time);
            reminderCanvas.addReminder(reminder);


            textInput.value = '';
            timeInput.value = '';
        }
    </script>
</body>
</html>